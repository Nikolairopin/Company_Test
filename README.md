# –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ üìú
–≠—Ç–æ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –ø–æ—Å—Ç–∞–≤–µ–Ω–Ω—ã–µ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –∑–∞–¥–∞–Ω–∏–∏:
## –í–æ–ø—Ä–æ—Å—ã:
1 "–ö–∞–∫ —Ö–æ—Ä–æ—à–æ –í—ã –≤–ª–∞–¥–µ–µ—Ç–µ Python? –û—Ü–µ–Ω–∏—Ç–µ —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –ø–æ —à–∫–∞–ª–µ –æ—Ç 0 –¥–æ 10" 

–ï—Å–ª–∏ –≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏ –∏ –æ –±–∞–∑–æ–≤—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö python, —Ç–æ —è –±—ã –æ—Ü–µ–Ω–∏–ª —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –Ω–∞ 7 –±–∞–ª–ª–æ–≤ - –∑–Ω–∞—é –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å —Ç–∏–ø–∞–º–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã–º, –∑–Ω–∞—é –æ–±—ä–µ–∫—Ç–æ-–æ—Ä–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–¥–Ω–∞–∫–æ –ø–∏—Ç–æ–Ω –æ—á–µ–Ω—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–µ–Ω (–¥–∞–∂–µ –≤ —Ä–∞–º–∫–∞—Ö –±–∞–∑–æ–≤–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏), –ø–æ—ç—Ç–æ–º—É –Ω–µ –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –¥–æ—Å–∫–æ–Ω–∞–ª—å–Ω–æ –∑–∞–Ω–∞—é –≤—Å–µ –º–µ—Ç–æ–¥—ã –∏ –∞—Ç—Ä–∏–±—É—Ç—ã –±–∞–∑–æ–≤–æ–≥–æ —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–µ –≥–æ–≤–æ—Ä—è —É–∂–µ –æ –æ–≥—Ä–æ–º–Ω–æ–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.

2 "–ù–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –í—ã –∑–Ω–∞–∫–æ–º—ã —Å Google Sheets?"

–ù–µ –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –æ–±–ª–∞–¥–∞—é –æ–≥—Ä–æ–º–Ω—ã–º–∏ –∑–∞–Ω–∞–∏—è–º–∏ –≤ google sheets. –Ø —É–º–µ—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å api –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –æ—Ç google.auth. –ö–∞—Å–∞—Ç–µ–ª—å–Ω–æ –≥—É–ª —Ç–∞–±–ª–∏—Ü —É–º–µ—é —Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º—ã, –ø–∏—Å–∞—Ç—å —Ñ—É–∫—Ü–∏–∏, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã, –∑–Ω–∞–∫–æ–º —Å —Ñ—É–∫—Ü–∏–æ–Ω–∞–ª–æ–º –º–∞–∫—Ä–æ—Å–æ–≤.

## –ó–∞–¥–∞—á–∏ –Ω–∞ –ª–æ–≥–∏–∫—É:
### –ó–∞–¥–∞—á–∞ 1:
–ö –ø–æ–ª—É–¥–Ω—é –æ—Å—Ç–∞–ª–æ—Å—å = 40*(1-0,5) = 20 $
–ö –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –æ—Å—Ç–∞–ª–æ—Å—å = 20*(1-0,8)= 4 $
## –û—Ç–≤–µ—Ç: 4 $
### –ó–∞–¥–∞—á–∞ 2:
–ö–æ–ª-–≤–æ –¥–Ω–µ–π = 216/(9*8*(120/(24*6))) = 3,6 –¥–Ω–µ–π 
// —Ç.–∫. —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–∞—Å–∞ = 120/(24*6)
## –û—Ç–≤–µ—Ç: 3,6 –¥–Ω–µ–π
### –ó–∞–¥–∞—á–∞ 3:
–ü—É—Å—Ç—å —Ö - –∫–æ–ª-–≤–æ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –±–∞–Ω–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –æ–±–µ–∏—Ö –∫–æ–º–ø–∞–Ω–∏—è—Ö
–¢–æ–≥–¥–∞: 200 = 80 + 60 + —Ö +3x 
—Ö = 15
## –û—Ç–≤–µ—Ç: 15 —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –±–∞–Ω–µ—Ä–æ–≤
### –ó–∞–¥–∞—á–∞ 4:
–£ –î–∂–æ–Ω–∞ –∏ –ö–µ–π—Ç - –æ–Ω–∏ –æ–±–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Instagram –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç YouTube –° Facebook-–æ–º
## –û—Ç–≤–µ—Ç: –£ –î–∂–æ–Ω–∞ –∏ –ö–µ–π—Ç 
### –ó–∞–¥–∞—á–∞ 5:
–ü—É—Å—Ç—å —Ö - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–∞–∂–µ—Ä –ø–æ–ª—É—á–∏–ª –∑–∞ –ø—è—Ç—ã–π –º–æ–¥—É–ª—å
–¢–æ–≥–¥–∞: (4*78+—Ö)/5=80
—Ö = 88
## –û—Ç–≤–µ—Ç: 88 –±–∞–ª–ª–æ–≤
### –ó–∞–¥–∞—á–∞ 6:
(260/80-260/10)*60 = 390 
## –û—Ç–≤–µ—Ç: 390 –º–∏–Ω.
## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å
1. –í—ã—á–∏—Å–ª–∏—Ç–µ –æ–±—â—É—é –≤—ã—Ä—É—á–∫—É –∑–∞ –∏—é–ª—å 2021 –ø–æ —Ç–µ–º —Å–¥–µ–ª–∫–∞–º, –ø—Ä–∏—Ö–æ–¥ –¥–µ–Ω–µ–∂–Ω—ã—Ö
—Å—Ä–µ–¥—Å—Ç–≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω.
```python
mask=df_cop["status"]=="–ò—é–ª—å 2021"
mask_t=df_cop["status"]=="–ê–≤–≥—É—Å—Ç 2021"
index_July = df_cop.index[mask].tolist()[0]
index_August = df_cop.index[mask_t].tolist()[0]

df_selection = df_cop.loc[index_July+1:index_August-1]

df_selection["status"].value_counts()
answer_one=df_selection[df_selection.status=="–û–ü–õ–ê–ß–ï–ù–û"]["sum"].sum()
answer_one
```
### –û—Ç–≤–µ—Ç 859895.75
2. –ö–∞–∫ –∏–∑–º–µ–Ω—è–ª–∞—Å—å –≤—ã—Ä—É—á–∫–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –∑–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã–π –ø–µ—Ä–∏–æ–¥?
–ü—Ä–æ–∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫–æ–º.
```python
months=["–ú–∞–π","–ò—é–Ω—å","–ò—é–ª—å","–ê–≤–≥—É—Å—Ç","–°–µ–Ω—Ç—è–±—Ä—å","–û–∫—Ç—è–±—Ä—å"]
income=[]
for i in range(len(months)):
    try:
        mask_one=df_cop["status"]==f"{months[i]} 2021"
        mask_two=df_cop["status"]==f"{months[i+1]} 2021"
        index_one = df_cop.index[mask_one].tolist()[0]
        index_two = df_cop.index[mask_two].tolist()[0]
        df_selection = df_cop.loc[index_one+1:index_two-1]
        gain=df_selection[df_selection.status=="–û–ü–õ–ê–ß–ï–ù–û"]["sum"].sum()
        income.append(gain)
    except:
        mask_one=df_cop["status"]==f"{months[-1]} 2021"
        index_one = df_cop.index[mask_one].tolist()[0]
        df_selection = df_cop.loc[index_one+1:]
        gain=df_selection[df_selection.status=="–û–ü–õ–ê–ß–ï–ù–û"]["sum"].sum()
        income.append(gain)
```
```python
 total_revenue = sum(income)

percentage_revenue = [(r / total_revenue) * 100 for r in income]

fig, ax1 = plt.subplots(figsize=(12, 6))

bars = ax1.bar(months, income, color='blue', label='Income')

x = np.arange(len(months))
coefficients = np.polyfit(x, income, 1)
trend_line = np.polyval(coefficients, x)

ax1.plot(months, trend_line, color='red', label='–õ–∏–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞')

for bar, value in zip(bars, income):
    yval = bar.get_height()
    ax1.text(bar.get_x() + bar.get_width()/2, yval, f'{value:.2f}', ha='center', va='bottom')

ax2 = ax1.twinx()
ax2.set_ylabel('–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–π –ø—Ä–∏–±—ã–ª–∏', color='green')
ax2.plot(months, percentage_revenue, color='green', marker='o', label='–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–π –ø—Ä–∏–±—ã–ª–∏')

plt.title('Income –∏ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–π –ø—Ä–∏–±—ã–ª–∏ –ø–æ –º–µ—Å—è—Ü–∞–º')
ax1.set_xlabel('–ú–µ—Å—è—Ü')
ax1.set_ylabel('–í—ã—Ä—É—á–∫–∞', color='blue')
ax1.legend(loc='upper left')
ax2.legend(loc='upper right')
plt.grid(axis='y')

plt.show()
```
![image](https://github.com/Nikolairopin/Company_Test/assets/126417867/00afe3dd-b929-42f4-b858-71b872797e9d)
3 –ö—Ç–æ –∏–∑ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø—Ä–∏–≤–ª–µ–∫ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –≤
—Å–µ–Ω—Ç—è–±—Ä–µ 2021?
```python
mask=df_cop["status"]=="–°–µ–Ω—Ç—è–±—Ä—å 2021"
mask_t=df_cop["status"]=="–û–∫—Ç—è–±—Ä—å 2021"
index_September = df_cop.index[mask].tolist()[0]
index_October = df_cop.index[mask_t].tolist()[0]

df_selection = df_cop.loc[index_September+1:index_October-1]
managers_score=df_selection.groupby("sale")["sum"].sum().sort_values(ascending=False)
answer_three=managers_score.index[0]
answer_three
```
### –û—Ç–≤–µ—Ç: –°–º–∏—Ä–Ω–æ–≤
4. –ö–∞–∫–æ–π —Ç–∏–ø —Å–¥–µ–ª–æ–∫ (–Ω–æ–≤–∞—è/—Ç–µ–∫—É—â–∞—è) –±—ã–ª –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—â–∏–º –≤ –æ–∫—Ç—è–±—Ä–µ 2021?
```python
 mask=df_cop["status"]=="–û–∫—Ç—è–±—Ä—å 2021"
index_October = df_cop.index[mask].tolist()[0]

df_selection = df_cop.loc[index_October+1:]
answer_four=df_selection["new/current"].value_counts().sort_values(ascending=False).index[0]
answer_four
```
### –û—Ç–≤–µ—Ç: —Ç–µ–∫—É—â–∞—è
5 –°–∫–æ–ª—å–∫–æ –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–≤ –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –º–∞–π—Å–∫–∏–º —Å–¥–µ–ª–∫–∞–º –±—ã–ª–æ –ø–æ–ª—É—á–µ–Ω–æ –≤ –∏—é–Ω–µ 2021?
```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è datetime—Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç–æ–ª–±—Ü–µ receiving date 
def to_date_time(date):
    if pd.isna(date) or date == "-":
        return pd.NaT
    else:
        try:
            return pd.to_datetime(date, format="%d.%m.%Y")
        except ValueError:
            # If parsing fails, try with two-digit year
            return pd.to_datetime(date, format="%d.%m.%y")
 
df_cop["receiving_date"]=df_cop["receiving_date"].apply(to_date_time)
mask=df_cop["status"]=="–ò—é–Ω—å 2021"
mask_t=df_cop["status"]=="–ò—é–ª—å 2021"
index_June = df_cop.index[mask].tolist()[0]
index_July = df_cop.index[mask_t].tolist()[0]

df_selection = df_cop.loc[index_July+1:index_August-1]
df_selection=df_selection[df_selection["receiving_date"].dt.month==8]
df_selection=df_selection.dropna(subset=["receiving_date"])
answer_five=df_selection.count().iloc[0]
answer_five
``` 
### –û—Ç–≤–µ—Ç: 81
## –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ 
```python
 mask_t=df_cop["status"]=="–ò—é–ª—å 2021"
index_t = df_cop.index[mask_t].tolist()[0]

df_selection = df_cop.loc[2:index_t-1]
df_cur = df_selection[(df_selection["new/current"] == "—Ç–µ–∫—É—â–∞—è")&
                        (df_selection["status"] != "–ü–†–û–°–†–û–ß–ï–ù–û")&
                        (df_selection["receiving_date"].dt.month >= 7) & 
                        (df_selection["receiving_date"].dt.day >= 1)]

df_new = df_selection[(df_selection["new/current"] == "–Ω–æ–≤–∞—è") & 
                      (df_selection["status"] == "–û–ü–õ–ê–ß–ï–ù–û") & 
                      (df_selection["receiving_date"].dt.month >= 7) & 
                      (df_selection["receiving_date"].dt.day >= 1)]
df_new.loc[:, "residue"] = df_new["sum"] * 0.07
df_cur.loc[:, "residue"] = df_cur["sum"].apply(lambda x: x * 0.05 if x > 10000 else x * 0.03)
coct_table=pd.concat([df_new,df_cur],axis=0)

answer_final=coct_table.groupby("sale")["sum"].sum().sort_values(ascending=False)
answer_final
```
### –û—Ç–≤–µ—Ç:
* –°–æ–∫–æ–ª–æ–≤,8973.700195
* –í–∞—Å–∏–ª—å–µ–≤,30996.695312
* –§–∏–ª–∏–º–æ–Ω–æ–≤–∞,63408.722656
* –°–µ–ª–∏–≤–∞–Ω–æ–≤,93981.8125
* –ê–Ω–¥—Ä–µ–µ–≤,103276.304688
* –ö—É–∑–Ω–µ—Ü–æ–≤–∞,141471.875
* –ò–≤–∞–Ω–æ–≤,149812.828125
* –°–º–∏—Ä–Ω–æ–≤,178021.828125
* –ü–µ—Ç—Ä–æ–≤–∞,273685.0625


